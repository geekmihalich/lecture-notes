# Найдено оптимальное решение

> [!INFO] Этот случай описывает ситуацию, когда для заданного значения $t_0$ удалось найти оптимальный план. Мы хотим понять, для какого диапазона $t$ этот план останется оптимальным.

Если мы ищем $\max$ линейной формы, то признаком оптимальности опорного плана является **неотрицательность коэффициентов $P_i'$ строки критерия** (в симплексной таблице).

Эти коэффициенты (коэффициенты целевой функции, выраженной через небазисные переменные) можно представить в виде следующей суммы:
$$P_i' = P_{1i}' + t \cdot P_{2i}', \quad i = 1,\dots,n.$$
Так как план оптимален для $t=t_0$, то:
$$P_i'(t_0) \ge 0, \quad i = 1,\dots,n,$$
и, следовательно, совместна система неравенств (из неотрицательности коэффициентов):
$$P_{1i}' + t \cdot P_{2i}' \ge 0, \quad i = 1,\dots,n. \quad (2)$$

---

## Определение диапазона оптимальности

Для всех значений $t$ где $P_{2i}' < 0$, неравенства этой системы (2) можно переписать в виде:
$$t \le -\frac{P_{1i}'}{P_{2i}'}.$$
А для всех $t$ где $P_{2i}' > 0$, в виде:
$$t \ge -\frac{P_{1i}'}{P_{2i}'}.$$

Введем следующие обозначения (они определяют границы интервала):
$$\bar{t} = \begin{cases} \max_{i | P_{2i}' < 0} \left(-\frac{P_{1i}'}{P_{2i}'}\right), & \text{если есть } P_{2i}' < 0 \\ -\infty, & \text{если все } P_{2i}' \ge 0 \end{cases}$$
$$\bar{\bar{t}} = \begin{cases} \min_{i | P_{2i}' > 0} \left(-\frac{P_{1i}'}{P_{2i}'}\right), & \text{если есть } P_{2i}' > 0 \\ \infty, & \text{если все } P_{2i}' \le 0 \end{cases} \quad (3)$$

> [!INFO] Таким образом, можно утверждать, что если:
> $$\bar{t} \le t \le \bar{\bar{t}}, \quad (4)$$
> то найденный оптимальный план для $t_0$ будет оставаться оптимальным для всех $t$, удовлетворяющих неравенству (4).
> (Это и есть **интервал оптимальности** текущего опорного плана.)

---

## Исследование соседних интервалов

Если область изменения $t$, заданная в технических условиях (например, $[t_1, t_2]$), не накрывается отрезком $[\bar{t}, \bar{\bar{t}}]$, то возникает необходимость исследования параметрической модели на области:
*   $t < \bar{t}$ (если $\bar{t}$ конечно и не равно $-\infty$)
*   $t > \bar{\bar{t}}$ (если $\bar{\bar{t}}$ конечно и не равно $\infty$)

Это происходит в том случае, если хотя бы одна из найденных границ $\bar{t} < \infty$ или $\bar{\bar{t}} > -\infty$.

### Исследуем задачу на области $t > \bar{\bar{t}}$

Пусть $\bar{\bar{t}} = \min_{i | P_{2i}' > 0} \left(-\frac{P_{1i}'}{P_{2i}'}\right)$ (т.е. $\bar{\bar{t}}$ конечна).
Тогда в опорный план (в базис) необходимо ввести переменную $x_k$, соответствующую столбцу $k$, для которого достигается этот минимум $\bar{\bar{t}}$.
Просматривается $k$-й столбец коэффициентов в таблице.
*   Если среди них нет положительных, то при $t > \bar{\bar{t}}$ линейная форма не ограничена на допустимом множестве (задача неограничена).
*   Если есть положительные коэффициенты, то среди них выбираем тот, для которого отношение свободного члена к соответствующему положительному коэффициенту минимально. Он и берется в качестве разрешающего элемента.

> [!INFO] Для нового плана получаем, что $t' = \bar{\bar{t}}$, т.е. наше $\bar{\bar{t}}$ становится левой границей нового интервала. Далее находится правая граница нового интервала.
> Если $t' = \infty$ или $t' > t_2$ (больше правой границы заданного интервала $[t_1, t_2]$), то исследование в этом направлении прекращается.

### Аналогично проводится исследование параметрической модели для $t < \bar{t}$

В этом случае в базис вводят переменную, соответствующую столбцу, по которому найдено значение $\bar{t}$.

> [!INFO] В результате такого исследования за конечное число итераций ось $t (-\infty, \infty)$ разобьётся на множества оптимальности, каждому из которых соответствует свой оптимальный план.

---

## Особенности алгоритма для параметрической модели

Алгоритм метода последовательного улучшения плана для параметрической модели обладает некоторыми особенностями. Вместо одной строки критерия вводятся три дополнительные строки $P_1', P_2'$ и $-P_1'/P_2'$ (для случая 1) и две строки $P_1' + t P_2'$ и $P_2'$ (в случае [[Случай 2 (ПЛП)|случая 2]]).

Процесс решения начинается с анализа для некоторого $t=t_0$. После выявления [[Случай 1 (ПЛП)|случая 1]], вводят строки $P_1', P_2'$ и $-P_1'/P_2'$. Начальное значение $t_0$ стараются выбрать таким образом, чтобы при анализе движение по оси $t$ происходило в одном фиксированном направлении.

*   **Движение вправо ( $t > t_0$ ):** строку с $-P_1'/P_2'$ заполняют лишь для позиций, соответствующих $P_2' < 0$. Если все позиции последней строки оказались незаполненными, то текущий опорный план оптимален для всех $t \ge t_0$, т.е. $[t_0, \infty)$. В противном случае индекс минимального элемента этой строки определит индекс переменной, которую надо сделать базисной, а значение этого элемента совпадет с правой границей множества оптимальности текущего опорного плана.
*   **Движение влево ( $t < t_0$ ):** заполняются лишь строки, соответствующие $P_2' > 0$. В этом случае, если последняя строка останется не заполненной, то текущий опорный план оптимален для всех $t \le t_0$, $(-\infty, t_0)$. Незаполненность последней строки при движении в фиксированном направлении является признаком прекращения анализа в этом направлении, т.е. план остается оптимальным при стремлении $t$ к $\pm \infty$.

> [!INFO] Если в модели $t \in [t_1, t_2]$, то этот процесс может закончиться раньше, как только область анализа охватит этот интервал.