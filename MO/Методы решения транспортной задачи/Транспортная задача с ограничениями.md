### Транспортная задача с ограничениями на пропускные способности путей сообщения

Транспортная задача [[Методы решения транспортной задачи|линейного программирования]] с ограничениями на пропускные способности путей сообщения может быть сформулирована следующим образом.
Необходимо минимизировать транспортные расходы:
$$Q(X) = \sum_{i=1}^m \sum_{j=1}^n c_{ij} \cdot x_{ij} \rightarrow \min$$
при ограничениях:
*   Суммарный запас в пункте $i$:
    $$\sum_{j=1}^n x_{ij} = a_i, \quad i = 1,\dots,m$$
*   Суммарная поставка в пункт $j$:
    $$\sum_{i=1}^m x_{ij} = b_j, \quad j = 1,\dots,n$$
*   Все перевозки неотрицательны:
    $$x_{ij} \ge 0, \quad i = 1,\dots,m, j = 1,\dots,n$$
*   **Ограничение на пропускную способность пути:**
    $$x_{ij} \le d_{ij}, \quad i = 1,\dots,m, j = 1,\dots,n$$

**Где:**
*   $c_{ij}$ - стоимость перевозки единицы продукции из пункта $i$ в пункт $j$;
*   $x_{ij}$ – планируемая величина перевозок из пункта $i$ в пункт $j$ (план перевозок $X$ – матрица размерности $m \times n$);
*   $b_j$ - потребности в продукте в пункте $j$;
*   $a_i$ - запасы в пункте $i$;
*   $d_{ij}$ – ограничение на величину планируемой перевозки из пункта $i$ в пункт $j$.

> [!INFO] Алгоритм состоит из 2-х этапов:
> 1.  Определение опорного плана;
> 2.  Определение оптимального плана [[Метод потенциалов (ТЗ)|методом потенциалов]].

---

### Метод потенциалов для определения оптимального плана (с пропускными способностями)

1.  Пусть у нас есть опорный план. Для перевозок вида $0 < x_{ij} < d_{ij}$ (т.е. путь используется, но не полностью загружен).
    Для определения потенциалов $u_i$ и $v_j$ соответствующих пунктов отправления и пунктов назначения составляется система уравнений:
    $$v_j - u_i = c_{ij}, \quad (2)$$
    и находятся потенциалы $u_i$ и $v_j$.

2.  Для остальных клеток транспортной таблицы вычисляются значения:
    $$c_{ij} - (v_j - u_i). \quad (3)$$

    *   **Если для свободных клеток** $x_{ij}=0$:
        $$\alpha_{ij} = c_{ij} - (v_j - u_i) \ge 0. \quad (4)$$
    *   **И для полностью загруженных клеток** $x_{ij}=d_{ij}$:
        $$-\beta_{ij} = c_{ij} - (v_j - u_i) \le 0. \quad (4')$$
    *   (Если все эти условия выполнены, то опорный план транспортной задачи оптимален.)

3.  Если эти условия не выполняются, то среди отрицательных чисел $\alpha_{ij}$ и $\beta_{ij}$ выбираем наибольшее (по модулю нарушение). Пусть это наименьшее из чисел соответствует перевозке с индексами $i_0$ и $j_0$.
    Возможно 2 варианта:
    *   **а) Наименьшее из чисел соответствует $x_{i_0 j_0} = 0$** (нулевая перевозка, которую нужно увеличить).
    *   **б) Наименьшее из чисел соответствует $x_{i_0 j_0} = d_{i_0 j_0}$** (перевозка на пределе пропускной способности, которую нужно уменьшить).

    Начиная с перевозки $x_{i_0 j_0}$, строим замкнутый цикл из базисных перевозок транспортной задачи.
    *   **В случае а) (ввод $x_{i_0 j_0}$ в базис):** Помечаем перевозки цикла, начиная с $(i_0, j_0)$, поочередно знаками «+» и «–» ( $x_{i_0 j_0}$ помечаем знаком «+»).
        *   Определяем для отрицательной полуцепи $\theta' = \min \{x_{ij}^-\}$ (минимальная перевозка, которую можно убрать).
        *   Для положительной полуцепи $\theta'' = \min \{d_{ij}^+ - x_{ij}^+\}$ (сколько ещё можно добавить).
        *   И берем $\theta = \min \{\theta', \theta'', d_{i_0 j_0}\}$ (общий шаг увеличения).
        *   Для получения более экономичного плана перевозки положительной полуцепи увеличиваем на $\theta$, а отрицательной – уменьшаем на $\theta$. (Одна из $x_{ij}^-$ становится 0, одна из $x_{ij}^+$ становится $d_{ij}^+$, а $x_{i_0 j_0}$ становится $\theta$).
    *   **В случае б) (вывод $x_{i_0 j_0}$ из базиса):** Помечаем перевозку $x_{i_0 j_0}$ знаком «–», а остальные перевозки цикла помечаем последовательно «+» и «–».
        *   Определяем $\theta'$ для отрицательной полуцепи и $\theta''$ для положительной полуцепи аналогично.
        *   И берем $\theta = \min \{\theta', \theta''\}$.
        *   Увеличиваем перевозки положительной полуцепи на $\theta$, а перевозки отрицательной полуцепи уменьшаем на $\theta$. ( $x_{i_0 j_0}$ становится $d_{i_0 j_0} - \theta$).

После этого переходим к п.1 (пересчет потенциалов) и повторяем.