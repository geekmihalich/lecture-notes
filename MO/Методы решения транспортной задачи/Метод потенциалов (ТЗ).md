

> [!INFO] Метод потенциалов позволяет находить **оптимальный план перевозок** транспортной таблицы. Он основан на [[Двойственность задачи ЛП|теории двойственности]] для транспортной задачи.

В основе лежит следующая теорема:

### Теорема (об оптимальности плана)

> [!THEOREM] Для того, чтобы некоторый план $X = [x_{ij}]_{m \times n}$ транспортной задачи был оптимальным, необходимо и достаточно, чтобы ему соответствовала такая система $m+n$ чисел $u_1, u_2, \dots, u_m$ (потенциалы отправителей) и $v_1, v_2, \dots, v_n$ (потенциалы получателей), для которой выполняются условия:
> 1.  **Условия потенциальности для занятых клеток (базисных):**
>     $v_j - u_i = c_{ij}, \quad \forall x_{ij} > 0.$
> 2.  **Условия потенциальности для свободных клеток (небазисных):**
>     $v_j - u_i \le c_{ij}, \quad \forall x_{ij} = 0.$

> [!DEFINITION] Величины $u_i$ и $v_j$ называются **потенциалами** соответствующих пунктов отправления и пунктов назначения.
> План $X$ будем называть **потенциальным**, если для него существует система $u_i$ и $v_j$, удовлетворяющая условиям (1)-(2).

> [!THEOREM] Тогда теорема коротко формулируется следующим образом: Для оптимальности плана транспортной задачи необходимо и достаточно, чтобы он был **потенциален**.

## Алгоритм метода потенциалов (общий)

Алгоритм метода потенциалов состоит из **предварительного этапа** и **повторяющегося основного этапа**.

### Предварительный этап

1.  Каким-либо способом ищется допустимый план $X$ ([[Методы построения опорного плана (ТЗ)#Метод северо-западного угла (ТЗ)|методом северо-западного угла]] или [[Методы построения опорного плана (ТЗ)#Метод минимального элемента (ТЗ)|минимального элемента]]).
2.  Для полученного плана строится система $m+n$ чисел $u_1, \dots, u_m$ и $v_1, \dots, v_n$, таких, что $v_j - u_i = c_{ij}, \quad \forall x_{ij} > 0$.
    *   (Мы имеем $m+n$ переменных, но только $m+n-1$ уравнений для базисных клеток. Поэтому один из потенциалов можно выбрать произвольно, например $u_1 = 0$, и затем найти остальные).
3.  Построенная система $u_i$ и $v_j$ исследуется на потенциальность, то есть, план $X$ исследуется на оптимальность. Для этого проверяется $v_j - u_i \le c_{ij}, \quad \forall x_{ij} = 0$.
    *   Если система потенциальна (все неравенства выполнены), то оптимальный план найден.
    *   Если система не потенциальна (хотя бы одно неравенство нарушено), то переходят к основному этапу (план не оптимален).

### Основной этап

1.  **Улучшаем план.** То есть, от плана $X$ переходим к плану $X'$ такому, что $Q(X') < Q(X)$ (для минимизации).
    *   Выбираем клетку $(i_0, j_0)$, для которой неравенство $v_j - u_i \le c_{ij}$ нарушается в наибольшей степени, т.е., находится число:
        $\alpha_{i_0 j_0} = \max \{v_j - u_i - c_{ij} > 0\}$ среди тех клеток, для которых условие потенциальности не выполняется.
    *   Начиная с клетки $(i_0, j_0)$, в направлении против часовой стрелки строится **цепь (цикл)** из заполненных клеток таблицы.
    *   Помечаем клетки в цикле, начиная с $(i_0, j_0)$, попеременно знаками «+» и «–».
    *   Клетки со знаками «+» образуют положительную полуцепь, а со знаками «–» – отрицательную полуцепь.
    *   В клетках отрицательной полуцепи ищем минимальную перевозку: $\theta = \min \{x_{ij}^-\}$.
    *   Теперь улучшаем план: перевозки отрицательной полуцепи уменьшаем на величину $\theta$, а перевозки положительной полуцепи увеличиваем на $\theta$. Новые перевозки: $x_{ij}' = x_{ij}^- - \theta$ (для "-"), $x_{ij}' = x_{ij}^+ + \theta$ (для "+").
    *   (Одна из $x_{ij}$ в отрицательной полуцепи станет 0, выходя из базиса, а $x_{i_0 j_0}$ войдет в базис).

2.  Для нового плана $X'$ строим новую систему $u_i', v_j'$ (как на предварительном этапе).
3.  Исследуем новую систему $u_i', v_j'$ на потенциальность. Если система не потенциальна, то переходим к п.1 основного этапа. Иначе найден оптимальный план.
