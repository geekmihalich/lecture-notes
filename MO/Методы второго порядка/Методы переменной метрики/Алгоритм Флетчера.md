
Флетчером был предложен алгоритм, в котором условие окончания процесса для квадратичной функции после $n$ шагов было отброшено, но сохранено свойство, заключающееся в том, что для квадратичных функций $\eta \rightarrow H^{-1}(\bar{x})$ в том смысле, что собственные значения $\eta$ стремятся к собственным значениям $H^{-1}$.

Полученное Флетчером соотношение для очередного приближения матрицы $\eta$ имеет вид:
$$\eta^{k+1} = E - \frac{\Delta \bar{x}^k (\Delta \bar{g}^k)^T}{(\Delta \bar{x}^k)^T \Delta \bar{g}^k} \cdot \eta^k \cdot E - \frac{\Delta \bar{g}^k (\Delta \bar{x}^k)^T}{(\Delta \bar{x}^k)^T \Delta \bar{g}^k} \cdot \eta^k + \frac{\Delta \bar{x}^k (\Delta \bar{x}^k)^T}{(\Delta \bar{x}^k)^T \Delta \bar{g}^k}. \quad (14)$$

Однако в реализованном Флетчером алгоритме матрица $\eta^k$ в зависимости от выполнения условий вычисляется по-разному:
Если:
А) $(\Delta \bar{g}^k)^T H^{-1}(\bar{x}^k) \Delta \bar{g}^k < (\Delta \bar{g}^k)^T \eta^k \Delta \bar{g}^k$;
то для вычисления очередного приближения $\eta^{k+1}$ используется соотношение (8) (это [[Метод Дэвидона-Флетчера-Пауэлла|метод Дэвидона-Флетчера-Пауэлла]]), а если
Б) $(\Delta \bar{g}^k)^T H^{-1}(\bar{x}^k) \Delta \bar{g}^k \ge (\Delta \bar{g}^k)^T \eta^k \Delta \bar{g}^k$,
то используется соотношение (14).

> [!CAUTION] Возникает вопрос, где взять $H^{-1}(\bar{x}^k)$?

> [!WARNING] Очевидно, что проверка условий (А-Б) затруднительна и теряет смысл, так как приходится находить $H^{-1}(\bar{x}^k)$. Поэтому при реализации алгоритма обычно используют формулу (14) без проверки условий (А-Б).

> [!INFO] Сравнение алгоритмов на тестовых функциях показывает, что в этом случае алгоритм Флетчера проигрывает по эффективности [[Метод Дэвидона-Флетчера-Пауэлла|алгоритму ДФП]].

> [!TIP] Эффективность алгоритмов ДФП и Флетчера в существенной мере определяют используемые [[Методы одномерного поиска|методы одномерного поиска]]. Зачастую успех конкретной реализации определяет именно эффективность используемых методов одномерного поиска.

В авторских реализациях методов ДФП и Флетчера решение задачи:
$$\lambda^k = \arg \min_{\lambda} f(\bar{x}^k + \lambda \bar{S}^k),$$
где $\bar{S}^k = -\eta(\bar{x}^k) \nabla f(\bar{x}^k)$, $\lambda^k$ определяется на интервале $(0, \lambda')$ с помощью кубической интерполяции.

---

## Выбор шага $\lambda$

Величина $\lambda'$ определяется:
$$\lambda' = \min \left(1, \frac{2[f(\bar{x}^k) - f_0]}{\nabla^T f(\bar{x}^k) \bar{S}^k}\right),$$
где $f_0$ – нижняя оценка значений $f(\bar{x})$, найденная в процессе одномерного поиска по направлению $\bar{S}^k$ (в процессе выделения интервала, содержащего минимум).

Если найденное в результате кубической интерполяции значение $\lambda$ оказывается больше $\lambda'$, то для пробных шагов начальное значение $\lambda$ берется в виде $\lambda^{r+1} = 0.1 \lambda^r$, где $r$ обозначает номер в последовательности шагов при одномерном поиске. А если $\lambda < \lambda'$ и $f(\bar{x}^k + \lambda \bar{S}^k) < f_0$, то одномерный поиск заканчивается.

> [!NOTE] Вообще говоря, применение квадратичной интерполяции при одномерном поиске нисколько не хуже кубической. И алгоритмы оказываются столь же эффективными.