
> [!INFO] Реальная разница алгоритмов [[Методы переменной метрики|метода переменной метрики]] заключается в нахождении $\Delta \eta$. В этом алгоритме матрица $\Delta \eta$ имеет ранг 2.

Как и в предыдущем случае, матрица $\eta$ перевычисляется таким образом, чтобы для квадратичной функции после $n$ шагов она совпала с матрицей $H^{-1}(\bar{x}^k) = [\nabla^2 f(\bar{x}^k)]^{-1}$.

Исходная матрица обычно выбирается единичной: $\eta^0 = E$. Хотя предпочтительней задание начального приближения элементов этой матрицы аналитическими значениями вторых частных производных или их конечно-разностными приближениями.

Соотношение для $\Delta \eta^k$ в алгоритме Дэвидона-Флетчера-Пауэлла можно получить путем подстановки $\bar{y}^k = \Delta \bar{x}^k$ и $\bar{z}^k = \eta^k \cdot \Delta \bar{g}^k$ в уравнение (6) из [[Методы переменной метрики]]:
$$\Delta \eta^k = \frac{1}{\omega} \left( \frac{\Delta \bar{x}^k \Delta \bar{x}^{kT}}{\Delta \bar{x}^{kT} \cdot \Delta \bar{g}^k} - \frac{\eta^k \cdot \Delta \bar{g}^k \Delta \bar{g}^{kT} \cdot \eta^{kT}}{\Delta \bar{g}^{kT} \cdot \eta^k \cdot \Delta \bar{g}^k} \right).$$
Тогда получим:
$$\eta^{k+1} = \eta^k + A^k - B^k = \eta^k + \frac{\Delta \bar{x}^k (\Delta \bar{x}^k)^T}{(\Delta \bar{x}^k)^T \cdot \Delta \bar{g}^k} - \frac{\eta^k \Delta \bar{g}^k (\Delta \bar{g}^k)^T \eta^{kT}}{(\Delta \bar{g}^k)^T \eta^k \Delta \bar{g}^k}. \quad (8)$$

> [!INFO] Следует отметить, что $A^k$ и $B^k$ являются симметрическими матрицами, так что $\eta^k$ симметрическая и $\eta^{k+1}$ будет симметрической.

Этот алгоритм является одним из наиболее эффективных алгоритмов переменной метрики. Алгоритм, использующий соотношение (8), оказывается достаточно эффективным при выполнении следующих условий:
1.  Ошибки округления при вычислении $\nabla f(\bar{x}^k)$ невелики.
2.  И матрица $\eta^k$ в процессе вычислений не становится "плохой".

В ходе оптимизации этим методом происходит постепенный переход от градиентного направления спуска к ньютоновскому. При этом используются преимущества каждого метода на соответствующем этапе.

---

## Роль матриц $A^k$ и $B^k$

Роль матриц $A^k$ в (8) заключается в обеспечении того, чтобы $\eta \rightarrow H^{-1}$, тогда как матрица $B^k$ обеспечивает положительную определенность матрицы $\eta^{k+1}$ на всех этапах и в пределе их сумма исключает начальную матрицу $\eta^0$.

Используем (8) на нескольких этапах, начиная с $\eta^0$:
$\eta^1 = E + A^0 - B^0,$
$\eta^2 = \eta^1 + A^1 - B^1 = E + (A^0 + A^1) - (B^0 + B^1),$
...
$\eta^{k+1} = E + \sum_{i=0}^k A^i - \sum_{i=0}^k B^i.$

В случае квадратичной целевой функции при $k=n-1$ должно выполняться равенство $H^{-1} = \sum_{i=0}^{n-1} A^i$, а сумма матриц $\sum_{i=0}^k B^i$ строится таким образом, чтобы она сократилась с начальным значением $\eta^0$.

> [!INFO] При квадратичной функции используемые направления поиска являются сопряженными. Именно это определяет эффективность алгоритма.