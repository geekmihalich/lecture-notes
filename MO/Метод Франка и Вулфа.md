
> [!INFO] **Метод Франка и Вулфа** предназначен для решения задач квадратичного программирования. Он представляет собой дальнейшее развитие [[Метод Баранкина и Дорфмана|метода Баранкина и Дорфмана]]. Метод действует **без ограничений** на этапе поиска направления.

---

## Задача квадратичного программирования

Рассматривается задача квадратичного программирования вида:
$$\min \{\bar{p}^T \bar{x} + \bar{x}^T C \bar{x} | A \bar{x} \le \bar{b}, \bar{x} \ge 0\}, \quad (1)$$
в которой $C$ - положительно полуопределенная матрица размерности $n \times n$, $A$ - матрица размерности $m \times n$.

---

## Условия Куна-Таккера для задачи

Условия Куна-Таккера для задачи (1) будут иметь вид (это система из [[Нелинейное программирование (ограничения-равенства)#Метод множителей Лагранжа|метода множителей Лагранжа]]):
$$\begin{cases} A \bar{x} + \bar{Y} = \bar{b} \\ 2C \bar{x} - \bar{V} + A^T \bar{\lambda} = -\bar{p} \\ \bar{x} \ge 0, \bar{V} \ge 0, \bar{Y} \ge 0, \bar{\lambda} \ge 0 \end{cases} \quad (2)$$
И дополнительное условие комплементарности:
$$\bar{x}^T \bar{V} + \bar{Y}^T \bar{\lambda} = 0, \quad (3)$$
где:
*   $\bar{V} = \nabla_{\bar{x}} F(\bar{x}, \bar{\lambda}) = \bar{p} + 2C \bar{x} + A^T \bar{\lambda}$
*   $\bar{Y} = -\nabla_{\bar{\lambda}} F(\bar{x}, \bar{\lambda}) = -\bar{A}\bar{x} + \bar{b}$

> [!INFO] Условие (3) может выполняться только для допустимого базисного решения системы (2), то есть для решения, в котором самое большее $N = n+m$ переменных из всех $2N = 2(n+m)$ переменных $\bar{x} \ge 0, \bar{V} \ge 0, \bar{Y} \ge 0, \bar{\lambda} \ge 0$ системы положительны. (То есть, не более $n+m$ компонент отличны от нуля).

---

## Общая формулировка для алгоритма

Решаемая задача формулируется следующим образом: среди допустимых базисных решений системы (2) найти такое, которое обращает в нуль величину $\bar{x}^T \bar{V} + \bar{Y}^T \bar{\lambda}$.

В методе Баранкина и Дорфмана (который является основой) начинают с некоторого базисного решения системы (2), необязательно удовлетворяющего условию (3), и с помощью симплексных преобразований сводят к нулю выпуклую функцию $\bar{x}^T \bar{V} + \bar{Y}^T \bar{\lambda}$.

---

## Алгоритм Франка и Вулфа

Все переменные системы (2) представим в виде $2N$-мерного вектора $\bar{z}$:
$$\bar{z}^T = (\bar{x}^T, \bar{Y}^T, \bar{V}^T, \bar{\lambda}^T) = (x_1,\dots,x_n, Y_1,\dots,Y_m, V_1,\dots,V_n, \lambda_1,\dots,\lambda_m).$$
Каждому такому вектору соответствует вектор $\bar{z}^* = (\bar{V}^T, \bar{\lambda}^T, \bar{x}^T, \bar{Y}^T)$.
> [!NOTE] Тут какая-то специфическая перестановка, видимо для внутренней работы алгоритма.

Очевидно, что $\bar{x}^T \bar{V} + \bar{Y}^T \bar{\lambda} = \frac{1}{2} \bar{z}^T \bar{z}^*$. (Это связь между целевой функцией и векторами).

И условия (2) и (3) можно записать в следующем виде:
$$\begin{cases} \begin{pmatrix} A & E & 0 & 0 \\ 2C & 0 & -E & A^T \end{pmatrix} \bar{z} = \begin{pmatrix} \bar{b} \\ -\bar{p} \end{pmatrix} \\ \bar{z} \ge 0 \end{cases} \quad (4)$$
И условие комплементарности (3) переписывается как:
$$\bar{z}^T \bar{z}^* = 0. \quad (5)$$

---

## Рекуррентное правило минимизации

Минимум $T(\bar{z}) = \bar{z}^T \bar{z}^*$ при ограничениях (4) достигается на некотором базисном решении (4) и равен нулю. Вектор $\bar{x}$, составленный из компонент $x_i$ оптимального вектора $\bar{z}^*$, является решением исходной задачи квадратичного программирования.

Работа алгоритма Франка и Вулфа начинается с некоторого базисного решения системы (4) $\bar{z}^0$ с соответствующей симплексной таблицей.
Функция $T(\bar{z}) = \bar{z}^T \bar{z}^*$ минимизируется по следующему рекуррентному правилу.

Пусть в результате $k$-го шага имеется некоторое допустимое базисное решение $\bar{Z}^k$, удовлетворяющее системе (4), вместе с соответствующей симплексной таблицей.
Пусть также имеется другое допустимое решение $\bar{w}^k$, удовлетворяющее системе (4), но не обязательно базисное, которому соответствует положительное значение функции $T$ (на первом шаге полагаем $\bar{w}^0 = \bar{z}^0$).

Исходя из базисного решения $\bar{Z}^k$ симплексным методом при ограничениях (4) минимизируем линейную относительно $\bar{z}$ форму $\bar{z}^T \bar{w}^k$.
В результате получим последовательность базисных решений $\bar{Z}^0 = \bar{z}^0, \bar{Z}^1, \bar{Z}^2, \dots$, причем таких, что линейная форма последовательно уменьшается:
$$(\bar{Z}^0)^T \bar{w}^k > (\bar{Z}^1)^T \bar{w}^k > (\bar{Z}^2)^T \bar{w}^k > \dots$$

Минимизация этой линейной формы обрывается, как только выполняется одно из условий:
1) $(\bar{Z}^k)^T \bar{w}^k = 0$; (4)
2) $(\bar{Z}^k)^T \bar{w}^k \le \frac{1}{2} T(\bar{w}^k)$. (5)

В первом случае $\bar{Z}^k$ представляет собой окончательное решение $\bar{z}^*$.
Во втором случае полагаем:
$$\bar{Z}^{k+1} = \bar{Z}^k,$$
$$\bar{w}^{k+1} = \bar{w}^k + \mu (\bar{Z}^{k+1} - \bar{w}^k),$$
где $\mu = \min \left\{1, \frac{(\bar{w}^k - \bar{Z}^{k+1})^T \bar{w}^k}{(\bar{Z}^{k+1} - \bar{w}^k)^T (\bar{Z}^{k+1} - \bar{w}^k)}\right\}$.

Франк и Вулф показали, что на каждом шаге имеет место или условие (4), или условие (5), и что через конечное число шагов будет обязательно выполнено условие (4), так что метод приводит к решению.
$\bar{w}^{k+1}$ есть такая точка отрезка прямой между $\bar{w}^k$ и $\bar{Z}^{k+1}$, в которой $T(\bar{z})$ достигает минимума на этом отрезке.

Если учесть, что $\frac{\partial T}{\partial \bar{z}} = 2\bar{z}$, то есть в частном случае $\left.\frac{\partial T}{\partial \bar{z}}\right|_{\bar{z}=\bar{w}^k} = 2\bar{w}^k$,
то видно, что линейная функция $\bar{z}^T \bar{w}^k$ получена линеаризацией функции $T$ в точке $\bar{w}^k$ и градиенты их совпадают.