
> [!INFO] Почти каждая задача линейного программирования (прямая задача) имеет "зеркальное отражение" - **двойственную задачу**. Решение одной задачи часто дает информацию о решении другой.

Рассмотрим задачу максимизации линейной формы (1) и, одновременно, задачу минимизации (2):

**Прямая задача (прямая):**
$$Q(\bar{x}) = \bar{p}^T \cdot \bar{x} \rightarrow \max$$
при условиях:
$$\begin{cases} A \cdot \bar{x} \le \bar{b} \\ \bar{x} \ge 0 \end{cases} \quad (1)$$

**Двойственная задача (двойственная):**
$$W(\bar{u}) = \bar{b}^T \cdot \bar{u} \rightarrow \min$$
при условиях:
$$\begin{cases} A^T \cdot \bar{u} \ge \bar{p} \\ \bar{u} \ge 0 \end{cases} \quad (2)$$

> [!DEFINITION] Задача (2) называется **двойственной** по отношению к прямой (1) (и наоборот!).

---

## Пример: Двойственная задача в экономике

**Предприятие выпускает три вида продукции.** Каждая продукция требует обработки на трех различных типах установок. Ресурс времени каждого типа установок ограничен. Известна прибыль от единицы каждого вида продукции $p_1, p_2, p_3$.
Если количество выпускаемой продукции каждого вида $x_1, x_2, x_3$, тогда необходимо максимизировать прибыль:
$$Q(\bar{x}) = p_1 x_1 + p_2 x_2 + p_3 x_3 \rightarrow \max$$
при ограничениях (по времени на установках):
$$\begin{cases} a_{11}x_1 + a_{12}x_2 + a_{13}x_3 \le b_1 \\ a_{21}x_1 + a_{22}x_2 + a_{23}x_3 \le b_2 \\ a_{31}x_1 + a_{32}x_2 + a_{33}x_3 \le b_3 \end{cases}$$
$\bar{x} \ge 0$,
где $b_1, b_2, b_3$ – ресурсы времени установок первого, второго и третьего типов.
Величины $a_{ij}$ определяют количество ресурса времени установки $i$-го типа, которое необходимо для выпуска одной единицы продукции $j$-го вида.

**Двойственная к ней задача будет иметь вид:**
$$W(\bar{u}) = b_1 u_1 + b_2 u_2 + b_3 u_3 \rightarrow \min$$
при ограничениях (оценки стоимости единицы продукции):
$$\begin{cases} a_{11}u_1 + a_{21}u_2 + a_{31}u_3 \ge p_1 \\ a_{12}u_1 + a_{22}u_2 + a_{32}u_3 \ge p_2 \\ a_{13}u_1 + a_{23}u_2 + a_{33}u_3 \ge p_3 \end{cases}$$
$\bar{u} \ge 0$.

> [!INFO] Здесь $u_1$ - это **оценка (цена)**, соответствующая одной единице ограниченного ресурса по первой установке. И она равна величине, на которую могла бы увеличиться суммарная прибыль, если бы количество этого ограниченного ресурса увеличилось на единицу, и если это увеличение было бы использовано оптимально.
> Иными словами, $u_1$ – это количество прибыли, недополученной из-за нехватки единицы ограниченного ресурса $b_1$.
> Аналогичным образом можно интерпретировать смысл величин $u_2$ и $u_3$.
> (По сути, двойственная задача ищет "цены" ресурсов, которые минимизируют общую "стоимость" этих ресурсов, но при этом каждая единица продукции должна иметь стоимость, не меньшую, чем ее прибыль).

---

## Преобразования при решении прямой и двойственной задач

Пусть имеются прямая и двойственная задачи следующего вида:

| **Прямая задача:** | **Представим ограничения в виде:** |
| :---------------- | :---------------------------------- |
| $Q(\bar{x}) = \bar{p}^T \cdot \bar{x} \rightarrow \max$ | $\bar{y} = -A \cdot \bar{x} + \bar{b} \ge 0$ |
| $A \cdot \bar{x} \le \bar{b}$ | $\bar{x} \ge 0$                    |
| $\bar{x} \ge 0$          |                                     |
| **Двойственная к ней задача:** | **Представим ограничения в виде:** |
| $W(\bar{u}) = \bar{b}^T \cdot \bar{u} \rightarrow \min$ | $\bar{v} = A^T \cdot \bar{u} - \bar{p} \ge 0$ |
| $A^T \cdot \bar{u} \ge \bar{p}$ | $\bar{u} \ge 0$                    |
| $\bar{u} \ge 0$          |                                     |

### Совмещение симплексных таблиц

Таким образом, нетрудно заметить, что шаг модифицированного жорданова исключения над симплексной таблицей прямой задачи соответствует шагу обыкновенного жорданова исключения над симплексной таблицей двойственной задачи.

> [!INFO] Эти взаимно двойственные задачи можно совместить в одной симплексной таблице (см. [[Метод последовательного уточнения оценок|метод последовательного уточнения оценок]]).

Можно показать, что, решая основную задачу линейного программирования, решаем и двойственную к ней. И наоборот. Причем:
$$\max Q = \min W.$$

---

## Теоремы двойственности

### Основная теорема двойственности линейного программирования

> [!THEOREM] Пусть рассматривается пара двойственных задач:
> **Прямая:** $\begin{cases} Q(\bar{x}) = \bar{p}^T \cdot \bar{x} \rightarrow \max \\ A \cdot \bar{x} \le \bar{b} \\ \bar{x} \ge 0 \end{cases}$ (1)
> **Двойственная:** $\begin{cases} W(\bar{u}) = \bar{b}^T \cdot \bar{u} \rightarrow \min \\ A^T \cdot \bar{u} \ge \bar{p} \\ \bar{u} \ge 0 \end{cases}$ (2)
> Если одна из этих задач обладает оптимальным решением, то и двойственная к ней задача также имеет оптимальное решение. Причем экстремальные значения соответствующих линейных форм равны: **$\max Q = \min W$**.
> Если же у одной из этих задач линейная форма не ограничена, то двойственная к ней задача противоречива.

**Доказательство (основные идеи):**
1.  Предположим, основная задача (1) имеет конечное оптимальное решение $\bar{x}^*$ и получена окончательная симплексная таблица.
2.  Из этой таблицы можно получить **оптимальное решение двойственной задачи** $\bar{u}^*$ (коэффициенты в строке $Q$ под соответствующими столбцами дополнительных переменных).
3.  Из свойств симплексной таблицы следует, что $Q(\bar{x}^*) = W(\bar{u}^*)$.
4.  Если прямая задача неограничена (т.е. $Q \rightarrow \infty$), то в соответствующем столбце симплексной таблицы нет положительных элементов (для минимизации). Это означает, что двойственная задача противоречива.

### Вторая теорема двойственности (Теорема о дополняющей нежесткости)

> [!THEOREM] Если хотя бы одно оптимальное решение одной из двойственных задач обращает $i$-е ограничение этой задачи в **строгое неравенство**, то $i$-я компонента (т.е. $x_i$ или $u_i$) каждого оптимального решения второй двойственной задачи равна **нулю**.
> Если же $i$-я компонента хотя бы одного оптимального решения одной из двойственных задач **положительна**, то каждое оптимальное решение другой двойственной задачи обращает $i$-е ограничение в **строгое равенство**.

Т.е. оптимальные решения $\bar{x}^*$ и $\bar{u}^*$ пары двойственных задач удовлетворяют условиям:
$$\bar{x}_j^* \cdot \left[ \sum_{i=1}^m a_{ij} \cdot \bar{u}_i^* - p_j \right] = 0, \quad j=1,\dots,n. \quad (1)$$
$$\bar{u}_i^* \cdot \left[ \sum_{j=1}^n a_{ij} \cdot \bar{x}_j^* - b_i \right] = 0, \quad i=1,\dots,m. \quad (2)$$
> [!INFO] Это означает, что если $x_j^* > 0$, то соответствующее $j$-е ограничение двойственной задачи активно (равно $0$). И наоборот, если $u_i^* > 0$, то $i$-е ограничение прямой задачи активно (равно $0$). Если ограничение неактивно (строгое неравенство), то соответствующая переменная в другой задаче равна нулю.
> Это очень полезно для анализа оптимальных решений!