
> [!INFO] Симплекс-метод использует понятие **разрешающего элемента** для перехода от одного опорного плана к другому, улучшая значение целевой функции.

### При поиске оптимального плана (после нахождения опорного плана)

Если при поиске минимума в строке целевой функции $Q(\bar{x})$ есть коэффициенты больше нуля, то выбираем столбец с положительным коэффициентом в строке целевой функции в качестве **разрешающего столбца**. Пусть это столбец с номером $l$.

*   Для выбора **разрешающей строки** (разрешающего элемента) среди положительных коэффициентов разрешающего столбца выбираем ту (ту строку), для которого отношение коэффициента в столбце свободных членов к коэффициенту в разрешающем столбце минимально:
    $$\frac{b_r}{a_{rl}} = \min_{i | a_{il} > 0} \left\{ \frac{b_i}{a_{il}} \right\}.$$
    $a_{rl}$ – разрешающий (направляющий) элемент, строка $r$ – разрешающая.

*   Для перехода к следующей симплексной таблице (следующему опорному плану с меньшим значением целевой функции) делается **шаг модифицированного жорданова исключения** с разрешающим элементом $a_{rl}$.

*   Если в разрешающем столбце нет положительных коэффициентов, то целевая функция неограничена снизу (при максимизации – неограничена сверху).

---

## Шаг модифицированного жорданова исключения

Этот шаг - ключевой в симплекс-методе!
Над симплексной таблицей выполняются следующие действия:
1.  На месте разрешающего элемента $a_{rl}$ ставится 1 и делится на $a_{rl}$ (т.е. $a_{rl} \rightarrow 1$).
2.  Остальные элементы разрешающего столбца (кроме $a_{rl}$) меняют знак на противоположный и делятся на $a_{rl}$. (т.е. $a_{il} \rightarrow -a_{il}/a_{rl}$ для $i \ne r$).
3.  Остальные элементы разрешающей строки (кроме $a_{rl}$) делятся на $a_{rl}$. (т.е. $a_{rj} \rightarrow a_{rj}/a_{rl}$ для $j \ne l$).
4.  Все остальные элементы симплексной таблицы $a_{ij}$ вычисляются по следующей формуле:
    $$a_{ij}' = a_{ij} - \frac{a_{il} \cdot a_{rj}}{a_{rl}}.$$
    (Это формула прямоугольника: элемент минус произведение диагональных элементов, деленное на разрешающий).

> [!TIP] **Результат:** После этого шага переменная, соответствующая разрешающему столбцу, входит в базис, а переменная, соответствующая разрешающей строке, выходит из базиса (становится небазисной).

### Пример (продолжение из [[Симплекс-метод|Симплекс-метода]]):

Начальная таблица:

| Базисные переменные | $-x_4$ | $-x_5$ | $1$ (свободные члены) |
| :------------------ | :----- | :----- | :-------------------- |
| $x_1 =$             | $1$    | $-2$   | $1$                   |
| $x_2 =$             | $-2$   | $1$    | $2$                   |
| $x_3 =$             | $3$    | $1$    | $3$                   |
| $Q(\bar{x})=$       | $-1$   | $1$    | $0$                   |

*   **Выбор разрешающего элемента:**
    *   В строке $Q(\bar{x})$ есть положительный коэффициент $1$ при $x_5$. Значит, $l=5$ (столбец $-x_5$) - разрешающий.
    *   Отношения $b_i/a_{i5}$ для $a_{i5} > 0$:
        *   Для $x_2$: $2/1 = 2$.
        *   Для $x_3$: $3/1 = 3$.
    *   Минимальное отношение 2, соответствует строке $x_2$. Значит, $r=2$ (строка $x_2$) - разрешающая.
    *   Разрешающий элемент $a_{25} = 1$.

*   **Применяем модифицированное жорданово исключение:**
    *   На месте $a_{25}$ ставим $1$.
    *   Остальные элементы столбца $-x_5$ меняют знак и делятся на 1:
        *   $a_{15} = -2 \rightarrow -(-2)/1 = 2$.
        *   $a_{35} = 1 \rightarrow -1/1 = -1$.
        *   Коэффициент в $Q$: $1 \rightarrow -1/1 = -1$.
    *   Элементы разрешающей строки $x_2$ делятся на 1: $a_{24}=-2 \rightarrow -2/1 = -2$, $b_2=2 \rightarrow 2/1 = 2$.
    *   Остальные элементы по формуле $a_{ij}' = a_{ij} - \frac{a_{il} \cdot a_{rj}}{a_{rl}}$:
        *   $a_{14}' = a_{14} - \frac{a_{15} \cdot a_{24}}{a_{25}} = 1 - \frac{-2 \cdot -2}{1} = 1 - 4 = -3$.
        *   $b_1' = b_1 - \frac{a_{15} \cdot b_2}{a_{25}} = 1 - \frac{-2 \cdot 2}{1} = 1 + 4 = 5$.
        *   $a_{34}' = a_{34} - \frac{a_{35} \cdot a_{24}}{a_{25}} = 3 - \frac{1 \cdot -2}{1} = 3 + 2 = 5$.
        *   $b_3' = b_3 - \frac{a_{35} \cdot b_2}{a_{25}} = 3 - \frac{1 \cdot 2}{1} = 3 - 2 = 1$.
        *   Коэффициент в $Q$ при $-x_4$: $-1 - \frac{1 \cdot -2}{1} = -1 + 2 = 1$.
        *   Свободный член в $Q$: $0 - \frac{1 \cdot 2}{1} = -2$.

Новая таблица:

| Базисные переменные | $-x_4$ | $-x_2$ | $1$ (свободные члены) |
| :------------------ | :----- | :----- | :-------------------- |
| $x_1 =$             | $-3$   | $2$    | $5$                   |
| $x_5 =$             | $-2$   | $1$    | $2$                   |
| $x_3 =$             | $5$    | $-1$   | $1$                   |
| $Q(\bar{x})=$       | $1$    | $-1$   | $-2$                  |

> [!INFO] **Базисная переменная** $x_2$ заменена на $x_5$.

*   **Проверяем на оптимальность:**
    *   В строке $Q(\bar{x})$ есть положительный коэффициент $1$ при $x_4$. Значит, ещё не оптимально.
    *   Разрешающий столбец $-x_4$.
    *   Отношения $b_i/a_{i4}$ для $a_{i4} > 0$:
        *   Для $x_3$: $1/5$.
    *   Разрешающая строка $x_3$. Разрешающий элемент $a_{34} = 5$.

*   **Применяем модифицированное жорданово исключение (ещё раз!):**
    *   На месте $a_{34}$ ставим $1$.
    *   Остальные элементы столбца $-x_4$: $a_{14}=-3 \rightarrow -(-3)/5 = 3/5$, $a_{54}=-2 \rightarrow -(-2)/5 = 2/5$. Коэффициент в $Q$: $1 \rightarrow -1/5$.
    *   Элементы разрешающей строки $x_3$ делятся на 5: $a_{32}=-1 \rightarrow -1/5$, $b_3=1 \rightarrow 1/5$.
    *   Остальные элементы по формуле:
        *   $a_{12}' = a_{12} - \frac{a_{14} \cdot a_{32}}{a_{34}} = 2 - \frac{-3 \cdot -1}{5} = 2 - 3/5 = 7/5$.
        *   $b_1' = b_1 - \frac{a_{14} \cdot b_3}{a_{34}} = 5 - \frac{-3 \cdot 1}{5} = 5 + 3/5 = 28/5$.
        *   $a_{52}' = a_{52} - \frac{a_{54} \cdot a_{32}}{a_{34}} = 1 - \frac{-2 \cdot -1}{5} = 1 - 2/5 = 3/5$.
        *   $b_5' = b_5 - \frac{a_{54} \cdot b_3}{a_{34}} = 2 - \frac{-2 \cdot 1}{5} = 2 + 2/5 = 12/5$.
        *   Коэффициент в $Q$ при $-x_2$: $-1 - \frac{1 \cdot -1}{5} = -1 + 1/5 = -4/5$.
        *   Свободный член в $Q$: $-2 - \frac{1 \cdot 1}{5} = -2 - 1/5 = -11/5$.

Финальная таблица:

| Базисные переменные | $-x_3$ | $-x_2$ | $1$ (свободные члены) |
| :------------------ | :----- | :----- | :-------------------- |
| $x_1 =$             | $3/5$  | $7/5$  | $28/5$                |
| $x_5 =$             | $2/5$  | $3/5$  | $12/5$                |
| $x_4 =$             | $1/5$  | $-1/5$ | $1/5$                 |
| $Q(\bar{x})=$       | $-1/5$ | $-4/5$ | $-11/5$               |

*   **Проверяем на оптимальность:**
    *   Все коэффициенты в строке $Q(\bar{x})$ ($-1/5$ и $-4/5$) **неположительны**.
    *   Значит, **оптимальное решение найдено!**

*   **Оптимальный план:** Небазисные $x_3=0, x_2=0$. Базисные:
    *   $x_1 = 28/5 = 5.6$
    *   $x_5 = 12/5 = 2.4$
    *   $x_4 = 1/5 = 0.2$
    *   $\bar{x}^* = [5.6, 0, 0, 0.2, 2.4]^T$.
*   **Оптимальное значение целевой функции:** $Q(\bar{x}^*) = -11/5 = -2.2$.