
> [!INFO] Иногда называют ещё **двойственным симплекс-методом**.

Ранее говорилось, что одновременно с решением прямой задачи решается и двойственная задача. Если проследить за получающимися преобразованиями двойственной таблицы и переменными $u_i$ и $x_j$, записав таблицу для двойственной задачи в обычном виде, то получим описание нового метода – метода последовательного уточнения оценок.

Пусть дана задача (двойственная):
$W(\bar{u}) = b_1 u_1 + b_2 u_2 + \dots + b_m u_m \rightarrow \min$
при ограничениях:
$\begin{cases} a_{11}u_1 + \dots + a_{r1}u_r + \dots + a_{m1}u_m - p_1 \ge 0 \\ \dots \\ a_{1n}u_1 + \dots + a_{rn}u_r + \dots + a_{mn}u_m - p_n \ge 0 \end{cases}$
$\bar{u} \ge 0$.

### Симплексная таблица для двойственной задачи

Симплексная таблица, построенная для данной задачи (с добавленными искусственными переменными $v_j \ge 0$, которые преобразуют неравенства $\ge$ в равенства), будет иметь вид:

| | $u_1$ | $\dots$ | $u_r$ | $\dots$ | $u_m$ | $1$ (свободные члены) |
| :------- | :----- | :------ | :----- | :------ | :----- | :-------------------- |
| $v_1 =$  | $a_{11}$ | $\dots$ | $a_{1r}$ | $\dots$ | $a_{1m}$ | $-p_1$                |
| $\dots$  | $\dots$  | $\dots$ | $\dots$  | $\dots$ | $\dots$  | $\dots$               |
| $v_S =$  | $a_{S1}$ | $\dots$ | $a_{Sr}$ | $\dots$ | $a_{Sm}$ | $-p_S$                |
| $\dots$  | $\dots$  | $\dots$ | $\dots$  | $\dots$ | $\dots$  | $\dots$               |
| $v_n =$  | $a_{n1}$ | $\dots$ | $a_{nr}$ | $\dots$ | $a_{nm}$ | $-p_n$                |
| $W =$    | $b_1$    | $\dots$ | $b_r$    | $\dots$ | $b_m$    | $0$                   |

---

## Правила выбора разрешающего элемента (поиск опорного плана для двойственной задачи)

В методе последовательного уточнения оценок сначала избавляются от отрицательности в $W$-строке (получают **псевдоплан**), а затем, перебирая псевдопланы, ищут оптимальный план (первый найденный опорный).

### Правило выбора разрешающего элемента для избавления от отрицательности в $W$-строке.

1.  Если все коэффициенты $W$-строки неотрицательны, то $0$ является оценкой снизу для целевой функции $W$ и можно переходить к отысканию оптимального решения. Иначе выбираем некоторый $b_r < 0$ и рассматриваем $r$-й столбец (это столбец, соответствующий базисной переменной $u_r$).
2.  Находим в $r$-м столбце какой-нибудь из отрицательных элементов, например, $a_{rs} < 0$. Тогда строку с номером $s$, содержащую $a_{rs}$, выбираем в качестве разрешающей строки.
    *   Если же все коэффициенты $r$-го столбца неотрицательны, то либо $W$ неограничена снизу ($W \rightarrow -\infty$), либо система ограничений противоречива. (Из противоречивости двойственной не следует неограниченность прямой задачи).

> [!INFO] Шаг модифицированного жорданова исключения применяется так же, как в [[Правила выбора разрешающего элемента (ОП)|прямом симплекс-методе]], но с учетом, что мы работаем с "развернутой" таблицей.

---

## Поиск оптимального решения

3.  Находим неотрицательные отношения коэффициентов $W$-строки к коэффициентам разрешающей ($s$-й) строки.
    *   В качестве разрешающего берем тот элемент $a_{sk}$ $s$-й строки, для которого это отношение положительно и минимально, т.е. выбираем некоторый коэффициент $a_{sk}$, для которого:
        $$\frac{b_k}{a_{sk}} = \min_{j | a_{sj} > 0} \left\{ \frac{b_j}{a_{sj}} \right\}.$$
    *   Выбрав разрешающий элемент, делаем шаг обыкновенного жорданова исключения.
    *   Указанная последовательность действий выполняется до тех пор, пока все коэффициенты $W$-строки не станут неотрицательными.

> [!INFO] Если все $q_1, \dots, q_n$ – неотрицательны, то таблица соответствует оптимальному решению и $q_0 = \min W$, иначе, $q_0$ – оценка снизу для $W$.

### Правило выбора разрешающего элемента при поиске оптимального решения.

1.  В качестве разрешающей строки берем строку, содержащую отрицательный коэффициент в $Q$-строке, например, $q_s < 0$, и строка с номером $s$ будет разрешающей.
2.  В качестве разрешающего элемента выбираем тот положительный коэффициент $b_{ks}$ строки $s$, для которого:
    $$\frac{b_k}{b_{sk}} = \min_{j | b_{sj} > 0} \left\{ \frac{b_j}{b_{sj}} \right\}.$$
    *   Если в строке с номером $s$ нет положительных коэффициентов, то ограничения задачи противоречивы.

> [!INFO] После выбора разрешающего элемента делаем шаг обыкновенного жорданова исключения. После конечного числа шагов либо найдем оптимальное решение, либо можно убедимся в противоречивости ограничений задачи.

> [!NOTE] **Замечание:** Если в симплекс-методе мы приближаемся к оптимальному решению при поиске минимума сверху, передвигаясь по опорным планам, то в методе последовательного уточнения оценок при поиске минимума к оптимальному решению приближаемся снизу, причем промежуточные планы (псевдопланы) не являются опорными (лежат вне многогранника решений). Первое же допустимое решение (опорный план) будет оптимальным.
