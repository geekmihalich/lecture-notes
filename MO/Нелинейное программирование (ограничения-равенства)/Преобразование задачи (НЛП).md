
> [!INFO] При $d > 0$ для решения задачи (1) обычно, если это удается, поступают следующим образом: преобразуют условную задачу к безусловной меньшей размерности.

Пусть имеется задача (1) с системой ограничений:
$$\phi_i(\bar{x}) = \phi_i^*, \quad i = 1,\dots,m, \quad (2)$$
причем $d > 0$, т.е. $m < n$. Система ограничений совместна и лишних ограничений нет.

### Исключение переменных

Тогда часть переменных, а именно $m$, выразим в явном виде из (2) через другие $n-m$ переменных. Например, пусть $x_1, \dots, x_{n-m}$ - независимые переменные, а $x_{n-m+1}, \dots, x_n$ - зависимые.
Тогда:
$$\begin{cases} x_{n-m+1} = \Psi_1(x_1, x_2, \dots, x_{n-m}) \\ x_{n-m+2} = \Psi_2(x_1, x_2, \dots, x_{n-m}) \\ \dots \\ x_n = \Psi_m(x_1, x_2, \dots, x_{n-m}) \end{cases} \quad (3)$$

### Преобразование целевой функции

В критерий $Q(\bar{x})$ вместо зависимых переменных $x_{n-m+1}, \dots, x_n$ подставляем выражения из (3):
$$Q(\bar{x}) = Q(x_1, x_2, \dots, x_{n-m}, \Psi_1(x_1, \dots, x_{n-m}), \dots, \Psi_m(x_1, \dots, x_{n-m})).$$
В результате получаем задачу **безусловной оптимизации меньшей размерности** $(n-m)$:
$$Q(x_1, x_2, \dots, x_{n-m}) \rightarrow \min (\max).$$

Следовательно, можем воспользоваться необходимыми условиями экстремума (приравнять частные производные к нулю) и найти решение исходной задачи (1), решив систему:
$$\frac{\partial Q(\cdot)}{\partial x_1} = 0$$
$$\dots$$
$$\frac{\partial Q(\cdot)}{\partial x_{n-m}} = 0. \quad (4)$$

> [!WARNING] Самое сложное при таком подходе – разрешить систему ограничений, представив ее в виде (3). Далеко не всегда это удается в элементарных функциях.

### Теорема о неявных функциях

> [!INFO] Вопрос о том, когда функции $\Psi_i(\cdot)$ существуют, дает **теорема о неявных функциях**.

Пусть все функции $\phi_i(\bar{x}) \in C^1$ (непрерывно дифференцируемы). Рассмотрим первые частные производные этих функций. Эти производные можно рассматривать как элементы прямоугольной матрицы $\Phi$ размерности $m \times n$:
$$\Phi = \left[\frac{\partial \phi_i}{\partial x_j}\right]_{m \times n}.$$
Из нее можно выделить $n! / (m!(n-m)!)$ различных подматриц порядка $m$. Например, если мы выбрали переменные $x_{j_1}, \dots, x_{j_m}$ для выражения через остальные, то матрица частных производных по этим переменным:
$$J_{\bar{x}}(j_1, j_2, \dots, j_m) = \begin{pmatrix}
\frac{\partial \phi_1}{\partial x_{j_1}} & \dots & \frac{\partial \phi_1}{\partial x_{j_m}} \\
\vdots & \ddots & \vdots \\
\frac{\partial \phi_m}{\partial x_{j_1}} & \dots & \frac{\partial \phi_m}{\partial x_{j_m}}
\end{pmatrix}.$$
> [!DEFINITION] Эта матрица называется **якобианом** функций $\phi_i(\bar{x})$ по переменным $x_{j_1}, \dots, x_{j_m}$. Индекс $\bar{x}$ указывает на точку, в которой вычислены элементы якобиана.

Пусть $k_1, k_2, \dots, k_{n-m}$ - множество индексов из числа $1, 2, \dots, n$, не принадлежащих множеству $j_1, j_2, \dots, j_m$.

### Условия существования неявных функций (Теорема о неявных функциях)

> [!THEOREM] Пусть $\bar{x}^0 = (x_1^0, x_2^0, \dots, x_n^0)^T \in E^n$ обладает следующими свойствами:
> 1.  В некоторой $\delta$-окрестности точки $\bar{x}^0$ функции $\phi_i(\bar{x}) \in C^1, \quad i = 1,\dots,m$.
> 2.  $\phi_i(\bar{x}^0) = 0, \quad i = 1,\dots,m$. (Т.е. $\bar{x}^0$ удовлетворяет ограничениям).
> 3.  Матрица якобиана $J_{\bar{x}^0}(j_1, j_2, \dots, j_m)$ - **неособенная** (её определитель не равен нулю).
>
> Тогда существует $\varepsilon$-окрестность ($\varepsilon>0$) точки $\hat{\bar{x}}^0 = (x_{k_1}^0, x_{k_2}^0, \dots, x_{k_{n-m}}^0)^T$ из $E^{n-m}$ такая, что для любой точки $\hat{\bar{x}} = (x_{k_1}, x_{k_2}, \dots, x_{k_{n-m}})^T$ из этой $\varepsilon$-окрестности существуют однозначные и непрерывные в точке $\hat{\bar{x}}^0$ функции $\Psi_1(\hat{\bar{x}}), \Psi_2(\hat{\bar{x}}), \dots, \Psi_m(\hat{\bar{x}})$, обладающие свойствами:
> А) $x_{j_i}^0 = \Psi_i(\hat{\bar{x}}^0), \quad i = 1,\dots,m$.
> Б) При любом $\hat{\bar{x}}$ из $\varepsilon$-окрестности $\hat{\bar{x}}^0$ значения $x_{j_i} = \Psi_i(\hat{\bar{x}})$ вместе с компонентами вектора $\hat{\bar{x}}$ образуют вектор $\bar{x}$, удовлетворяющий $\phi_i(\bar{x}) = 0, \quad i = 1,\dots,m$.
> В) В $\varepsilon$-окрестности $\hat{\bar{x}}^0$ функции $\Psi_i(\hat{\bar{x}})$ дифференцируемы и при данных $k_r, r=1,(n-m)$, производные $\frac{\partial \Psi_i}{\partial x_{k_r}}$ являются единственным решением системы уравнений:
> $$\sum_{u=1}^m \frac{\partial \phi_i}{\partial x_{j_u}} \frac{\partial \Psi_u}{\partial x_{k_r}} = -\frac{\partial \phi_i}{\partial x_{k_r}}, \quad i=1,\dots,m. \quad (5)$$

---

## Необходимые условия экстремума (для задачи с ограничениями)

Выведем необходимые условия, которым должна удовлетворять точка $\bar{x}^0$, доставляющая $Q(\bar{x})$ относительный максимум или минимум на множестве $D = \{\bar{x} | \phi_i(\bar{x}) = \phi_i^*, i = 1,\dots,m\}$.

Для начала рассмотрим функцию двух переменных с одним ограничением.
Пусть имеем $Q(x_1, x_2)$, $\phi(x_1, x_2) \in C^1$. Найдем необходимые условия, которым должна удовлетворять точка $\bar{x}^0 = (x_1^0, x_2^0)^T$, если в ней достигается относительный максимум (или минимум) при $\phi(x_1, x_2) = \phi^*$.

Допустим, что $\frac{\partial \phi}{\partial x_1}$ или $\frac{\partial \phi}{\partial x_2}$ не равна нулю в точке $\bar{x}^0$. Пусть $\frac{\partial \phi(x_0)}{\partial x_2} \ne 0$.
Тогда по теореме о неявных функциях существует $\varepsilon$-окрестность точки $x_1^0$ ($\hat{x}^0$), в которой можем разрешить $\phi(x_1, x_2) - \phi^* = 0$ относительно $x_2$ так, что $x_2 = \Psi(x_1)$, где $\Psi(\cdot)$ - непрерывно дифференцируемая функция в окрестности точки $x_1^0$, и $x_2^0 = \Psi(x_1^0)$.
Следовательно, мы можем исключить $x_2$ в $Q(x_1, x_2)$. Имеем:
$$h(x_1) = Q[x_1, \Psi(x_1)]$$
для $|x_1 - x_1^0| < \varepsilon$.
Но если $Q(x_1, x_2)$ имеет в точке $\bar{x}^0$ относительный максимум при $\phi(x_1, x_2) = \phi^*$, то должно существовать такое число $\varepsilon_0$, $0 < \varepsilon_0 < \varepsilon$, что для всех $x_1$ в $\varepsilon_0$-окрестности точки $x_1^0$ справедливо:
$$h(x_1) \le h(x_1^0).$$
Следовательно, $h$ имеет безусловный максимум в точке $x_1^0$. (Аналогично для минимума).
Сложная функция $h$ дифференцируема в окрестности $x_1^0$ и:
$$\frac{\partial h(\bar{x}^0)}{\partial x_1} = 0. \quad (6)$$
Дифференцируя $h$ как сложную функцию, получим:
$$\frac{\partial h}{\partial x_1} = \frac{\partial Q}{\partial x_1} + \frac{\partial Q}{\partial x_2} \frac{\partial \Psi}{\partial x_1},$$
так как по теореме о неявных функциях:
$$\frac{\partial \Psi}{\partial x_1} = -\frac{\partial \phi / \partial x_1}{\partial \phi / \partial x_2}.$$
Из (6) следует:
$$\frac{\partial Q(\bar{x}^0)}{\partial x_1} - \frac{\partial Q(\bar{x}^0)}{\partial x_2} \frac{\partial \phi(\bar{x}^0) / \partial x_1}{\partial \phi(\bar{x}^0) / \partial x_2} = 0.$$
Обозначим:
$$\lambda = \frac{\partial Q(\bar{x}^0) / \partial x_2}{\partial \phi(\bar{x}^0) / \partial x_2}.$$
Таким образом, необходимо, чтобы точка $\bar{x}^0$ удовлетворяла уравнениям:
$$\begin{cases} \frac{\partial Q(\bar{x}^0)}{\partial x_1} - \lambda \frac{\partial \phi(\bar{x}^0)}{\partial x_1} = 0 \\ \frac{\partial Q(\bar{x}^0)}{\partial x_2} - \lambda \frac{\partial \phi(\bar{x}^0)}{\partial x_2} = 0 \\ \phi(\bar{x}^0) = \phi^* \end{cases} \quad (7)$$
Т.е. удовлетворяла системе 3-х уравнений с тремя неизвестными: $x_1^0, x_2^0$ и $\lambda$.
Решив систему, найдем все точки, где $Q(\bar{x})$ достигает относительного максимума или минимума при $\phi(\bar{x}) = \phi^*$.